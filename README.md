# global-brain
## Running the Morrison-Young model
In the notebook `run_model_Lyapunov_spectrum.ipynb` you can find the `Python` implementation of the Morrison-Young model. The original model was written in `Julia` and can be found here: https://github.com/mmtree/Celegans_premotor/tree/main. The article can be found: https://doi.org/10.48550/arXiv.2501.00278.
### Some notes on the translation to Python
1. For the translation I did not redo the regression. This means I use the values determined by Morrison and Young for the bias term $d$, the value of $\beta$ and the weights of the synaptic connection matrix $A$. They can be found in Data folder.
2. Because I use $d$ and $A$ as a result from the original implementation, I had to make sure the order of the neurons is the same in the Python version as in the Julia version. The order is determined when the specific neurons are extracted from the dataset from White et al. (1986). Although the python version here uses a similar method as the original Julia version, the order of the neurons changes. Specifically, the list `final_neurons` is determined by determining the unique neurons present in the White et al. dataset. For both `Julia` and `Python` this method puts those unique elements in an arbitrary order and these order rarely agree between the two languages. To circumvent this, I saved the `final_neurons` list in Julia as a `csv` file and use that to create the `final_neurons` list in `Python`.
3. For running the model we use Atanas data. To use it in the model, the authors go through a few steps (smoothening the data, removing unlabeled time series, replace missing data) to prepare the data. Similarly as above, eventhough the `Python`steps are the same as the `Julia` steps, the resulting order of the data differs. Again, we imported the prepared data sets from the `Julia` versions. Specifically, the matrix `D` and `dDdt`. The steps to prepare the data in `Python` are still in the implementation, so it is possible to use them if you have redone the regression and are not bound by the order of $d$ and $A$ from the `Julia` implementation.
4. There are inconsistencies in the naming of the neurons between the paper and the implementation of Morrison and Young. Throughout the paper, they call the interneurons they model the *core neurons*. In their implementation however, they use this exact term for all neurons that have a part in the model, so this includes the signal neurons. The interneurons that are modelled are called *intrinsic neurons*. To prevent confusion, the `Python` version will use *core neurons* to mean the interneurons that are simulated by the model, *signal neurons* to mean the neurons of which the data will be used as a driving force into the model, and *model neurons* means the combination of core and signal neurons.
5. As discussed before, the order of the neurons is determined by the method of getting the connectome information from a White et al. dataset. This unfortunately means that the model neurons are not ordered based on whether they are core or signal neurons. Therefore, it is important to keep track of the indices of the specific neurons. From the White et al. dataset a dictionary is created called `final_neuron_dict` that contains all neurons present in that dataset. To run the model, a dataset from Atanas et al. (2023) is used. These datasets contain a specific number of labelled neurons and these will be captured in the list `model_neurons`. The list `ids_model` will in turn give the index of where the model neurons can be found in the `final_neuron_dict`. In the list of model neurons, we can distinguish the core and signal neurons. The list `ids_core` tells us the index of the core neurons in the list `model_neurons` and `ids_signal` does the same for the signal neurons.
6. Finally, the way the model is implemented disallows core neurons to be modelled if they are not present in the Atanas dataset, even when there is a regression weight available. This is because Morrison and Young wanted to compare the output of the model with the actual data, so modelling neurons of which you do not have data does not make sense. However, there are situations thinkable where it could be interesting to also model neurons of which the dataset is not present. The implementation does not allow for this at the moment.
### Data
For running the model I needed different datasets. 
1. Connectomic data from White et al. (1986). This dataset is called `df5.csv` and can be found in the 'Data' folder.
2. Time series from neurons from Atanas et al. (2023). This notebook will use one such dataset `atanas_kim_2023-2023-01-23-15.json`. This dataset can be found in the 'Atanas Data' folder in de 'Data' folder. Other Atanas datasets can be found there as well, source of the datasets: https://wormwideweb.org/activity/dataset/.
3. We use the regression results from Morrison and Young for bias term $d$ and synaptic ocnnection matrix $A$. These can be found in `avg_model_weights.jld2` in the 'Data' folder.
4. As stated before we load in the `final_neurons` list, `Dict_nms.json` and the matrices `D` and `dDdt` from the `Julia` implementation. These can be found in the 'Data' folder as well. For the matrices we determined the data for the six Atanas datasets in the folder, so the model can be easily run for any of those datasets. The matrices are linked to the datasets in the following manner:
    - `D`, `dDdt`: 2023-01-23-15
    - `D2`, `dDd2`: 2023-03-07-01
    - `D3`, `dDdt3`: 2023-01-23-21
    - `D4`, `dDdt4`: 2023-01-05-01
    - `D5`, `dDdt5`: 2023-01-09-15
    - `D6`, `dDdt6`: 2023-01-09-22
## Calculating the Lyapunov Spectrum using model-equations Jacobian
In the notebook `run_model_Lyapunov_spectrum.ipynb` the Lyapunov spectrum is calculated from the output of the model using the Jacobian determined from the model equations. This method is derived from the paper by Engelken et al. (2023) DOI: https://doi.org/10.1103/PhysRevResearch.5.043044.

Importantly, the derivation of the Jacobian can be found in the thesis. To calculate the Lyapunov spectrum we need to combine the output of the model (time series of the 15 core neurons) with the data (time series of the 69 signal neurons).
